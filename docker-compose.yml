services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "7860:7860"
    volumes:
      # Persist uploaded images and reports data
      - ./backend/data:/app/backend/data
      - ./backend/uploads:/app/backend/uploads
      # Mount weights directory (for model files)
      - ./backend/weights:/app/backend/weights
    environment:
      - WEIGHTS_YOLO=/app/backend/weights/best.pt
      - CKPT_FUSION=/app/backend/weights/fusion_resnet34_best.pt
      - SCALER_JSON=/app/backend/weights/scaler.json
    restart: unless-stopped
